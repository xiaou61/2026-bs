# 基于SpringBoot的校园场景下共享自行车租赁系统 - 产品需求文档（PRD）

## 一、项目概述

### 1.1 项目背景
随着绿色出行理念的普及和校园规模的不断扩大，学生在校园内的短途出行需求日益增加。传统的步行方式效率较低，而私人自行车存在停放管理混乱、易丢失、维护成本高等问题。校园共享自行车租赁系统应运而生，旨在为师生提供便捷、环保、经济的校园出行解决方案。

### 1.2 项目目标
- 构建一套完整的校园共享自行车租赁管理系统
- 实现自行车的智能化租借与归还流程
- 提供用户端、管理端的全方位功能支持
- 建立信用评价体系，促进文明用车
- 实现校园内自行车资源的高效调度与管理

### 1.3 项目范围
本系统面向高校校园场景，主要覆盖：
- 学生、教职工的日常短途出行需求
- 校园内多个停车点的车辆管理
- 租赁订单的全生命周期管理
- 费用结算与钱包充值
- 车辆维护与调度管理

---

## 二、用户角色分析

### 2.1 普通用户（学生/教职工）
| 属性 | 描述 |
|------|------|
| 用户特征 | 高校在校学生、教职工 |
| 核心需求 | 快速租车、便捷还车、费用透明 |
| 使用场景 | 宿舍-教学楼、食堂-图书馆等短途出行 |
| 痛点 | 找车困难、还车点满、费用不透明 |

### 2.2 系统管理员
| 属性 | 描述 |
|------|------|
| 用户特征 | 后勤管理人员、系统运营人员 |
| 核心需求 | 车辆管理、用户管理、数据统计 |
| 使用场景 | 日常运维、故障处理、数据分析 |
| 痛点 | 车辆调度困难、故障响应慢 |

### 2.3 运维人员
| 属性 | 描述 |
|------|------|
| 用户特征 | 车辆维修保养人员 |
| 核心需求 | 接收维修任务、更新车辆状态 |
| 使用场景 | 车辆维护、故障修复、定期巡检 |
| 痛点 | 任务分配不均、维修进度难追踪 |

---

## 三、功能需求

### 3.1 用户端功能模块

#### 3.1.1 用户认证模块
| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 用户注册 | 支持手机号/学号注册，实名认证 | P0 |
| 用户登录 | 账号密码登录、短信验证码登录 | P0 |
| 密码管理 | 密码修改、忘记密码找回 | P1 |
| 实名认证 | 上传学生证/工作证进行身份验证 | P0 |
| 个人信息 | 查看和修改个人基本信息 | P1 |

#### 3.1.2 自行车租借模块
| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 地图找车 | 在地图上显示附近停车点和可用车辆 | P0 |
| 扫码租车 | 扫描车身二维码开锁租车 | P0 |
| 手动输入 | 手动输入车辆编号租车 | P1 |
| 车辆详情 | 查看车辆信息（编号、类型、状态） | P1 |
| 预约用车 | 提前预约指定停车点的车辆 | P2 |

#### 3.1.3 骑行与还车模块
| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 骑行导航 | 显示到目的停车点的路线导航 | P1 |
| 骑行计时 | 实时显示骑行时长和预估费用 | P0 |
| 临时锁车 | 临时离开时锁定车辆，保持租借状态 | P1 |
| 还车操作 | 到达停车点后确认还车 | P0 |
| 还车拍照 | 还车时拍照上传，记录停放状态 | P2 |

#### 3.1.4 钱包与支付模块
| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 余额查询 | 查看钱包余额和押金状态 | P0 |
| 充值功能 | 支持多种金额充值 | P0 |
| 押金管理 | 缴纳押金、申请退还押金 | P0 |
| 消费记录 | 查看历史消费明细 | P1 |
| 充值记录 | 查看历史充值记录 | P1 |

#### 3.1.5 订单管理模块
| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 当前订单 | 查看进行中的租借订单 | P0 |
| 历史订单 | 查看已完成的订单列表 | P0 |
| 订单详情 | 查看订单的完整信息 | P1 |
| 订单申诉 | 对异常订单发起申诉 | P1 |
| 费用明细 | 查看订单费用计算详情 | P1 |

#### 3.1.6 故障上报模块
| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 故障上报 | 发现车辆问题时上报故障 | P1 |
| 故障类型 | 选择故障类型（刹车、车铃、轮胎等） | P1 |
| 图片上传 | 上传故障照片作为凭证 | P1 |
| 上报记录 | 查看自己的故障上报历史 | P2 |

#### 3.1.7 信用体系模块
| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 信用分查询 | 查看当前信用积分 | P1 |
| 信用规则 | 查看信用分加减规则说明 | P1 |
| 信用记录 | 查看信用分变动历史 | P2 |
| 信用等级 | 根据信用分划分等级享受优惠 | P2 |

### 3.2 管理端功能模块

#### 3.2.1 系统管理模块
| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 管理员登录 | 管理员账号密码登录 | P0 |
| 角色管理 | 管理系统角色及权限 | P1 |
| 操作日志 | 记录和查询系统操作日志 | P1 |
| 系统配置 | 配置系统参数（费率、押金等） | P1 |

#### 3.2.2 用户管理模块
| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 用户列表 | 查看所有注册用户 | P0 |
| 用户详情 | 查看用户详细信息和使用记录 | P1 |
| 用户审核 | 审核用户实名认证申请 | P0 |
| 用户禁用 | 禁用/启用用户账号 | P1 |
| 信用调整 | 手动调整用户信用分 | P1 |

#### 3.2.3 车辆管理模块
| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 车辆列表 | 查看所有车辆信息 | P0 |
| 车辆录入 | 添加新车辆到系统 | P0 |
| 车辆编辑 | 修改车辆信息 | P1 |
| 车辆报废 | 标记车辆为报废状态 | P1 |
| 车辆定位 | 查看车辆当前位置 | P1 |
| 批量导入 | 批量导入车辆数据 | P2 |

#### 3.2.4 停车点管理模块
| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 停车点列表 | 查看所有停车点 | P0 |
| 停车点新增 | 添加新的停车点 | P0 |
| 停车点编辑 | 修改停车点信息 | P1 |
| 容量设置 | 设置停车点最大容量 | P1 |
| 实时状态 | 查看停车点车辆数量 | P1 |
| 地图标注 | 在地图上管理停车点位置 | P1 |

#### 3.2.5 订单管理模块
| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 订单列表 | 查看所有租借订单 | P0 |
| 订单详情 | 查看订单完整信息 | P1 |
| 订单处理 | 处理异常订单 | P1 |
| 申诉处理 | 处理用户订单申诉 | P1 |
| 费用调整 | 手动调整订单费用 | P1 |
| 订单导出 | 导出订单数据 | P2 |

#### 3.2.6 财务管理模块
| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 收入统计 | 统计系统租借收入 | P1 |
| 充值记录 | 查看用户充值记录 | P1 |
| 退款管理 | 处理用户退款申请 | P1 |
| 押金管理 | 管理用户押金 | P0 |
| 财务报表 | 生成财务报表 | P2 |

#### 3.2.7 运维管理模块
| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 故障列表 | 查看所有故障上报 | P0 |
| 故障分配 | 分配故障给运维人员 | P1 |
| 维修记录 | 记录维修处理情况 | P1 |
| 运维人员 | 管理运维人员账号 | P1 |
| 调度任务 | 创建车辆调度任务 | P2 |

#### 3.2.8 数据统计模块
| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 首页概览 | 展示核心数据指标 | P0 |
| 使用统计 | 统计车辆使用情况 | P1 |
| 用户分析 | 分析用户使用行为 | P2 |
| 热力图 | 展示停车点使用热度 | P2 |
| 报表导出 | 导出统计报表 | P2 |

---

## 四、非功能需求

### 4.1 性能需求
| 指标 | 要求 |
|------|------|
| 响应时间 | 普通接口 < 500ms，复杂查询 < 2s |
| 并发能力 | 支持500+用户同时在线 |
| 数据库 | 支持10万级订单数据查询 |
| 可用性 | 系统可用性 > 99.5% |

### 4.2 安全需求
| 类型 | 要求 |
|------|------|
| 身份认证 | JWT Token认证机制 |
| 数据传输 | HTTPS加密传输 |
| 密码存储 | BCrypt加密存储 |
| 权限控制 | 基于RBAC的权限管理 |
| 日志审计 | 关键操作日志记录 |

### 4.3 兼容性需求
| 类型 | 要求 |
|------|------|
| 浏览器 | Chrome、Firefox、Edge、Safari最新两个版本 |
| 分辨率 | 适配1920x1080及以上分辨率 |
| 移动端 | 响应式设计，支持移动端访问 |

---

## 五、数据模型设计

### 5.1 核心实体

#### 5.1.1 用户表（user）
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | bigint | 主键ID |
| username | varchar(50) | 用户名 |
| password | varchar(255) | 密码（加密） |
| real_name | varchar(50) | 真实姓名 |
| phone | varchar(20) | 手机号 |
| student_id | varchar(30) | 学号/工号 |
| id_card | varchar(30) | 身份证号 |
| avatar | varchar(255) | 头像URL |
| gender | tinyint | 性别 |
| email | varchar(100) | 邮箱 |
| credit_score | int | 信用分 |
| status | tinyint | 状态（0禁用 1正常） |
| auth_status | tinyint | 认证状态 |
| create_time | datetime | 创建时间 |
| update_time | datetime | 更新时间 |

#### 5.1.2 自行车表（bicycle）
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | bigint | 主键ID |
| bike_no | varchar(30) | 车辆编号 |
| qr_code | varchar(255) | 二维码内容 |
| bike_type | tinyint | 车辆类型 |
| status | tinyint | 状态（0空闲 1使用中 2维修中 3报废） |
| station_id | bigint | 当前停车点ID |
| longitude | decimal(10,7) | 经度 |
| latitude | decimal(10,7) | 纬度 |
| total_mileage | decimal(10,2) | 总里程 |
| total_orders | int | 总订单数 |
| last_maintenance | datetime | 上次维护时间 |
| purchase_date | date | 购入日期 |
| create_time | datetime | 创建时间 |
| update_time | datetime | 更新时间 |

#### 5.1.3 停车点表（station）
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | bigint | 主键ID |
| station_name | varchar(100) | 停车点名称 |
| address | varchar(255) | 详细地址 |
| longitude | decimal(10,7) | 经度 |
| latitude | decimal(10,7) | 纬度 |
| capacity | int | 最大容量 |
| current_count | int | 当前车辆数 |
| status | tinyint | 状态 |
| description | varchar(500) | 描述 |
| create_time | datetime | 创建时间 |
| update_time | datetime | 更新时间 |

#### 5.1.4 租借订单表（rental_order）
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | bigint | 主键ID |
| order_no | varchar(50) | 订单编号 |
| user_id | bigint | 用户ID |
| bike_id | bigint | 车辆ID |
| start_station_id | bigint | 起始停车点ID |
| end_station_id | bigint | 结束停车点ID |
| start_time | datetime | 开始时间 |
| end_time | datetime | 结束时间 |
| duration | int | 骑行时长（分钟） |
| distance | decimal(10,2) | 骑行距离（km） |
| amount | decimal(10,2) | 订单金额 |
| status | tinyint | 状态（0进行中 1已完成 2异常 3已取消） |
| pay_status | tinyint | 支付状态 |
| return_photo | varchar(255) | 还车照片 |
| remark | varchar(500) | 备注 |
| create_time | datetime | 创建时间 |
| update_time | datetime | 更新时间 |

#### 5.1.5 用户钱包表（user_wallet）
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | bigint | 主键ID |
| user_id | bigint | 用户ID |
| balance | decimal(10,2) | 余额 |
| deposit | decimal(10,2) | 押金 |
| deposit_status | tinyint | 押金状态 |
| create_time | datetime | 创建时间 |
| update_time | datetime | 更新时间 |

#### 5.1.6 充值记录表（recharge_record）
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | bigint | 主键ID |
| user_id | bigint | 用户ID |
| amount | decimal(10,2) | 充值金额 |
| type | tinyint | 类型（1余额充值 2押金缴纳） |
| pay_method | tinyint | 支付方式 |
| status | tinyint | 状态 |
| transaction_no | varchar(50) | 交易流水号 |
| create_time | datetime | 创建时间 |

#### 5.1.7 消费记录表（consumption_record）
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | bigint | 主键ID |
| user_id | bigint | 用户ID |
| order_id | bigint | 订单ID |
| amount | decimal(10,2) | 消费金额 |
| type | tinyint | 类型 |
| description | varchar(255) | 描述 |
| create_time | datetime | 创建时间 |

#### 5.1.8 故障上报表（fault_report）
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | bigint | 主键ID |
| bike_id | bigint | 车辆ID |
| user_id | bigint | 上报用户ID |
| fault_type | tinyint | 故障类型 |
| description | varchar(500) | 故障描述 |
| images | varchar(1000) | 故障图片 |
| status | tinyint | 状态 |
| handler_id | bigint | 处理人ID |
| handle_time | datetime | 处理时间 |
| handle_result | varchar(500) | 处理结果 |
| create_time | datetime | 创建时间 |
| update_time | datetime | 更新时间 |

#### 5.1.9 信用记录表（credit_record）
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | bigint | 主键ID |
| user_id | bigint | 用户ID |
| change_value | int | 变动值 |
| change_type | tinyint | 变动类型 |
| reason | varchar(255) | 变动原因 |
| order_id | bigint | 关联订单ID |
| create_time | datetime | 创建时间 |

#### 5.1.10 管理员表（admin）
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | bigint | 主键ID |
| username | varchar(50) | 用户名 |
| password | varchar(255) | 密码 |
| real_name | varchar(50) | 真实姓名 |
| phone | varchar(20) | 手机号 |
| role_id | bigint | 角色ID |
| status | tinyint | 状态 |
| create_time | datetime | 创建时间 |
| update_time | datetime | 更新时间 |

---

## 六、技术架构

### 6.1 技术选型

#### 后端技术栈
| 技术 | 版本 | 说明 |
|------|------|------|
| Spring Boot | 2.7.x | 基础框架 |
| MyBatis-Plus | 3.5.x | ORM框架 |
| MySQL | 8.0 | 数据库 |
| Redis | 6.x | 缓存 |
| JWT | - | 身份认证 |
| Swagger | 3.x | API文档 |
| Hutool | 5.x | 工具类库 |

#### 前端技术栈
| 技术 | 版本 | 说明 |
|------|------|------|
| Vue.js | 3.x | 前端框架 |
| Element Plus | 2.x | UI组件库 |
| Axios | - | HTTP请求 |
| Pinia | - | 状态管理 |
| Vue Router | 4.x | 路由管理 |
| ECharts | 5.x | 图表组件 |

### 6.2 系统架构图
```
┌─────────────────────────────────────────────────────────┐
│                      前端层                              │
│  ┌─────────────────┐    ┌─────────────────┐            │
│  │   用户端 (Vue3)  │    │  管理端 (Vue3)   │            │
│  └────────┬────────┘    └────────┬────────┘            │
└───────────┼──────────────────────┼──────────────────────┘
            │                      │
            ▼                      ▼
┌─────────────────────────────────────────────────────────┐
│                    网关/API层                            │
│              Spring Boot REST API                        │
└─────────────────────────┬───────────────────────────────┘
                          │
┌─────────────────────────┼───────────────────────────────┐
│                    业务服务层                            │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌─────────┐ │
│  │ 用户服务  │  │ 车辆服务  │  │ 订单服务  │  │ 财务服务 │ │
│  └──────────┘  └──────────┘  └──────────┘  └─────────┘ │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐             │
│  │ 停车点服务│  │ 运维服务  │  │ 统计服务  │             │
│  └──────────┘  └──────────┘  └──────────┘             │
└─────────────────────────┬───────────────────────────────┘
                          │
┌─────────────────────────┼───────────────────────────────┐
│                    数据存储层                            │
│        ┌─────────┐            ┌─────────┐              │
│        │  MySQL  │            │  Redis  │              │
│        └─────────┘            └─────────┘              │
└─────────────────────────────────────────────────────────┘
```

---

## 七、接口设计

### 7.1 接口规范
- 基础URL: `/api/v1`
- 请求格式: JSON
- 响应格式: 统一JSON格式

```json
{
  "code": 200,
  "message": "success",
  "data": {}
}
```

### 7.2 核心接口列表

#### 用户端接口
| 接口 | 方法 | 路径 | 说明 |
|------|------|------|------|
| 用户注册 | POST | /user/register | 新用户注册 |
| 用户登录 | POST | /user/login | 用户登录 |
| 获取用户信息 | GET | /user/info | 获取当前用户信息 |
| 附近停车点 | GET | /station/nearby | 获取附近停车点 |
| 扫码租车 | POST | /rental/start | 扫码开始租车 |
| 还车 | POST | /rental/end | 确认还车 |
| 订单列表 | GET | /order/list | 获取订单列表 |
| 钱包余额 | GET | /wallet/balance | 获取钱包余额 |
| 充值 | POST | /wallet/recharge | 钱包充值 |
| 故障上报 | POST | /fault/report | 上报车辆故障 |

#### 管理端接口
| 接口 | 方法 | 路径 | 说明 |
|------|------|------|------|
| 管理员登录 | POST | /admin/login | 管理员登录 |
| 用户列表 | GET | /admin/user/list | 获取用户列表 |
| 车辆列表 | GET | /admin/bike/list | 获取车辆列表 |
| 新增车辆 | POST | /admin/bike/add | 添加新车辆 |
| 停车点列表 | GET | /admin/station/list | 获取停车点列表 |
| 订单列表 | GET | /admin/order/list | 获取订单列表 |
| 故障列表 | GET | /admin/fault/list | 获取故障列表 |
| 数据统计 | GET | /admin/stats/overview | 获取统计概览 |

---

## 八、计费规则

### 8.1 收费标准
| 项目 | 标准 |
|------|------|
| 押金 | 99元（信用分≥600可免押金） |
| 计费方式 | 按时长计费 |
| 收费标准 | 1元/30分钟，不足30分钟按30分钟计算 |
| 封顶费用 | 单日最高20元 |
| 夜间优惠 | 22:00-06:00 享8折 |

### 8.2 信用规则
| 行为 | 信用分变动 |
|------|-----------|
| 初始信用分 | 100分 |
| 正常还车 | +1分 |
| 规范停车 | +2分 |
| 上报故障 | +5分 |
| 超时未还 | -10分/次 |
| 违规停车 | -5分/次 |
| 损坏车辆 | -20分/次 |

---

## 九、项目里程碑

| 阶段 | 内容 | 预计时间 |
|------|------|----------|
| 第一阶段 | 需求分析与设计 | 1周 |
| 第二阶段 | 数据库设计与基础框架搭建 | 1周 |
| 第三阶段 | 后端核心功能开发 | 3周 |
| 第四阶段 | 前端用户端开发 | 2周 |
| 第五阶段 | 前端管理端开发 | 2周 |
| 第六阶段 | 系统联调与测试 | 1周 |
| 第七阶段 | 优化与文档编写 | 1周 |

---

## 十、附录

### 10.1 术语说明
| 术语 | 说明 |
|------|------|
| 停车点 | 校园内指定的自行车停放区域 |
| 信用分 | 用户行为评价体系的量化指标 |
| 临时锁车 | 短暂离开时锁定车辆但不结束计费 |
| 押金 | 用户使用服务前缴纳的保证金 |

### 10.2 参考文档
- Spring Boot 官方文档
- MyBatis-Plus 官方文档
- Vue.js 官方文档
- Element Plus 官方文档

---
