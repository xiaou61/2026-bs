<view class="container">
  <!-- ä»»åŠ¡ä¿¡æ¯ -->
  <view class="card">
    <view class="task-header">
      <text class="task-title">{{task.title}}</text>
      <text class="tag tag-info">{{signTypeText[task.signType]}}</text>
    </view>
    <view class="task-detail">
      <view class="detail-item">
        <text class="label">è¯¾ç¨‹</text>
        <text class="value">{{task.courseName || 'è¯¾ç¨‹'}}</text>
      </view>
      <view class="detail-item">
        <text class="label">æˆªæ­¢æ—¶é—´</text>
        <text class="value">{{task.endTime}}</text>
      </view>
    </view>
  </view>

  <!-- æ™®é€šç­¾åˆ° -->
  <view class="card sign-card" wx:if="{{task.signType == 1}}">
    <view class="sign-icon">âœ…</view>
    <text class="sign-tip">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å®Œæˆç­¾åˆ°</text>
    <button class="btn-primary sign-btn" bindtap="doSign">ç«‹å³ç­¾åˆ°</button>
  </view>

  <!-- å®šä½ç­¾åˆ° -->
  <view class="card sign-card" wx:if="{{task.signType == 2}}">
    <view class="sign-icon">ğŸ“</view>
    <text class="sign-tip">éœ€è¦åœ¨æŒ‡å®šä½ç½®èŒƒå›´å†…ç­¾åˆ°</text>
    <view class="location-info" wx:if="{{location}}">
      <text class="text-small text-gray">å½“å‰ä½ç½®: {{location.address || 'è·å–ä¸­...'}}</text>
    </view>
    <button class="btn-primary sign-btn" bindtap="getLocationAndSign">å®šä½ç­¾åˆ°</button>
  </view>

  <!-- äºŒç»´ç ç­¾åˆ° -->
  <view class="card sign-card" wx:if="{{task.signType == 3}}">
    <view class="sign-icon">ğŸ“·</view>
    <text class="sign-tip">æ‰«ææ•™å¸ˆå±•ç¤ºçš„äºŒç»´ç </text>
    <button class="btn-primary sign-btn" bindtap="scanQrCode">æ‰«ç ç­¾åˆ°</button>
  </view>

  <!-- æ•°å­—ç­¾åˆ° -->
  <view class="card sign-card" wx:if="{{task.signType == 4}}">
    <view class="sign-icon">ğŸ”¢</view>
    <text class="sign-tip">è¾“å…¥6ä½ç­¾åˆ°ç </text>
    <view class="code-input">
      <input 
        type="number" 
        maxlength="6" 
        placeholder="è¯·è¾“å…¥ç­¾åˆ°ç "
        value="{{signCode}}"
        bindinput="onCodeInput"
      />
    </view>
    <button class="btn-primary sign-btn" bindtap="doSign" disabled="{{signCode.length != 6}}">ç¡®è®¤ç­¾åˆ°</button>
  </view>

  <!-- ç­¾åˆ°æˆåŠŸ -->
  <view class="card sign-card success-card" wx:if="{{signSuccess}}">
    <view class="success-icon">ğŸ‰</view>
    <text class="success-text">ç­¾åˆ°æˆåŠŸï¼</text>
    <text class="success-status tag {{signResult.status == 1 ? 'tag-success' : 'tag-warning'}}">
      {{signResult.status == 1 ? 'æ­£å¸¸ç­¾åˆ°' : 'è¿Ÿåˆ°'}}
    </text>
    <button class="btn-secondary" bindtap="goBack">è¿”å›é¦–é¡µ</button>
  </view>
</view>
