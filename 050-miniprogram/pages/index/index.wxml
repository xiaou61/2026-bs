<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯ -->
  <view class="card user-card" wx:if="{{userInfo}}">
    <view class="user-info">
      <view class="avatar">{{userInfo.realName ? userInfo.realName[0] : 'ç”¨'}}</view>
      <view class="info">
        <text class="name">{{userInfo.realName || userInfo.username}}</text>
        <text class="role">{{userInfo.role == 0 ? 'å­¦ç”Ÿ' : (userInfo.role == 1 ? 'æ•™å¸ˆ' : 'ç®¡ç†å‘˜')}}</text>
      </view>
    </view>
    <view class="unread" wx:if="{{unreadCount > 0}}" bindtap="goMessage">
      <text>{{unreadCount}}</text>
    </view>
  </view>

  <!-- å¾…ç­¾åˆ°ä»»åŠ¡ï¼ˆå­¦ç”Ÿï¼‰ -->
  <view class="card" wx:if="{{userInfo && userInfo.role == 0}}">
    <view class="card-header">
      <text class="card-title">å¾…ç­¾åˆ°</text>
      <text class="text-gray text-small">{{activeTasks.length}}ä¸ªä»»åŠ¡</text>
    </view>
    <view wx:if="{{activeTasks.length > 0}}">
      <view class="task-item" wx:for="{{activeTasks}}" wx:key="id" bindtap="goSign" data-task="{{item}}">
        <view class="task-info">
          <text class="task-title">{{item.title}}</text>
          <text class="task-time text-gray text-small">æˆªæ­¢: {{item.endTime}}</text>
        </view>
        <view class="sign-type">
          <text class="tag tag-info">{{signTypeText[item.signType]}}</text>
        </view>
      </view>
    </view>
    <view class="empty" wx:else>
      <text>æš‚æ— å¾…ç­¾åˆ°ä»»åŠ¡</text>
    </view>
  </view>

  <!-- ä»Šæ—¥è¯¾è¡¨ -->
  <view class="card">
    <view class="card-header">
      <text class="card-title">ä»Šæ—¥è¯¾è¡¨</text>
      <text class="text-primary text-small" bindtap="goCourse">æŸ¥çœ‹å…¨éƒ¨</text>
    </view>
    <view wx:if="{{todaySchedules.length > 0}}">
      <view class="schedule-item" wx:for="{{todaySchedules}}" wx:key="id">
        <view class="time">
          <text>{{item.startTime}}</text>
          <text class="text-gray">-</text>
          <text>{{item.endTime}}</text>
        </view>
        <view class="course-info">
          <text class="course-name">{{item.courseName || 'è¯¾ç¨‹'}}</text>
          <text class="text-gray text-small">{{item.classroom}} {{item.building}}</text>
        </view>
      </view>
    </view>
    <view class="empty" wx:else>
      <text>ä»Šæ—¥æ— è¯¾ç¨‹å®‰æ’</text>
    </view>
  </view>

  <!-- å¿«æ·å…¥å£ -->
  <view class="card">
    <view class="quick-menu">
      <view class="menu-item" bindtap="goCourse">
        <view class="menu-icon">ğŸ“š</view>
        <text>æˆ‘çš„è¯¾ç¨‹</text>
      </view>
      <view class="menu-item" bindtap="goRecord">
        <view class="menu-icon">ğŸ“Š</view>
        <text>è€ƒå‹¤è®°å½•</text>
      </view>
      <view class="menu-item" bindtap="goLeave">
        <view class="menu-icon">ğŸ“</view>
        <text>è¯·å‡ç”³è¯·</text>
      </view>
      <view class="menu-item" bindtap="goMessage">
        <view class="menu-icon">ğŸ””</view>
        <text>æ¶ˆæ¯é€šçŸ¥</text>
      </view>
    </view>
  </view>

  <!-- æ•™å¸ˆå…¥å£ -->
  <view class="card" wx:if="{{userInfo && userInfo.role == 1}}">
    <view class="card-header">
      <text class="card-title">æ•™å¸ˆåŠŸèƒ½</text>
    </view>
    <view class="quick-menu">
      <view class="menu-item" bindtap="goCreateTask">
        <view class="menu-icon">âœ…</view>
        <text>å‘èµ·ç­¾åˆ°</text>
      </view>
      <view class="menu-item" bindtap="goTaskList">
        <view class="menu-icon">ğŸ“‹</view>
        <text>ç­¾åˆ°ä»»åŠ¡</text>
      </view>
      <view class="menu-item" bindtap="goApprove">
        <view class="menu-icon">âœï¸</view>
        <text>å®¡æ‰¹ç®¡ç†</text>
      </view>
      <view class="menu-item" bindtap="goStats">
        <view class="menu-icon">ğŸ“ˆ</view>
        <text>è€ƒå‹¤ç»Ÿè®¡</text>
      </view>
    </view>
  </view>
</view>
