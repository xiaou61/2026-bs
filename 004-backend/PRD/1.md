🧩 产品需求文档（PRD）
一、项目概述

项目名称： 基于 Spring Boot + WebSocket 的实时聊天与通知系统
开发方向： 即时通讯 / 前后端交互
主要技术栈：

后端：Spring Boot、WebSocket、MyBatis-Plus、Redis、MySQL

前端：Vue 3、Vite、Pinia、Axios、Element Plus

部署环境：JDK 17+、Redis、MySQL 8.0+

项目简介：
本系统是一个支持实时聊天与消息通知的综合平台，用户可进行单聊、群聊、好友添加等操作。系统利用 WebSocket 实现实时消息推送，并通过 Redis 实现用户在线状态管理与离线消息缓存。
同时，内置通知模块可在用户被点赞或评论时即时提醒，为后续扩展到论坛、社区类应用提供基础。

二、产品目标
目标	描述
💬 实时通信	用户之间可即时发送与接收消息，消息无延迟展示
📦 离线消息	用户离线期间的消息会被缓存，登录后自动接收
👥 好友系统	支持好友添加、删除、分组管理
🔔 通知提醒	点赞、评论等操作触发系统通知（非聊天消息）
🕓 聊天记录	支持消息记录持久化、历史查询与搜索
⚙️ 扩展性	可扩展为社区、论坛类平台的即时通知模块
三、系统架构设计
1. 整体架构
   ┌───────────────┐
   │     Vue3 前端  │
   │(聊天界面+通知中心)│
   └───────▲───────┘
   │ WebSocket
   │ REST API
   ┌───────┴───────┐
   │ Spring Boot 后端│
   │  ├ WebSocket服务│
   │  ├ 消息管理模块 │
   │  ├ 通知模块     │
   │  ├ 好友系统     │
   └───────▲───────┘
   │
   │ Redis (缓存、用户在线状态、离线消息)
   │
   ▼
   MySQL 数据库

四、核心功能说明
1️⃣ 用户与好友系统

功能描述：

用户注册、登录、个人信息修改。

支持添加好友、删除好友、好友请求验证。

支持分组（如“同学”、“同事”）。

数据表：

user：用户基本信息

friend：好友关系表

friend_group：好友分组表

交互逻辑：

好友请求通过后，双方自动建立好友关系。

在线状态由 Redis 记录（user:online:{userId}）。

2️⃣ 实时聊天模块

功能描述：

支持单聊、群聊。

消息通过 WebSocket 通道实时推送。

消息发送成功后前端即时展示。

功能要点：

消息格式（JSON）：

{
"type": "CHAT",
"fromUserId": 1,
"toUserId": 2,
"content": "你好呀！",
"timestamp": 1720000000000
}


使用 Redis 发布订阅实现跨节点同步消息。

离线用户消息存储于数据库中，登录后自动拉取。

数据表：

chat_message：存储消息内容（发送方、接收方、类型、时间戳、是否已读）

3️⃣ 离线消息与已读回执

功能描述：

当接收方不在线时，消息保存到数据库。

用户上线后自动推送离线消息。

支持已读回执（后端通过消息状态字段标记）。

数据表字段：

is_read：0=未读，1=已读

read_time：阅读时间戳

4️⃣ 通知模块（系统提醒）

功能描述：

当用户的内容被点赞或评论时触发系统通知。

通知通过 WebSocket 实时推送。

离线用户登录后可查看未读通知。

通知类型：

类型	示例
点赞提醒	“李子凡 点赞了你的帖子”
评论提醒	“张三 回复了你的评论：‘不错哟’”

数据表：

notification：通知记录表（发送者、接收者、类型、内容、时间、状态）

5️⃣ 聊天记录管理与搜索

功能描述：

支持按用户、关键词、时间段搜索聊天记录。

用户可删除聊天记录或清空会话。

交互逻辑：

前端提供搜索框 → 调用 /chat/history/search

支持模糊匹配与分页返回。

五、系统亮点与创新点
亮点	说明
⚡ 实时通信体验强	WebSocket 实时推送，无需轮询
🧠 Redis 缓存	管理在线用户与离线消息，减轻数据库压力
🧩 模块化设计	聊天、通知、好友系统相互独立，可复用
🔍 历史消息搜索	聊天记录可按关键词或日期查询
🔒 安全性	Token 鉴权 + 消息类型过滤防止注入
🔧 扩展性	通知模块可直接迁移到论坛/社交项目中使用
六、前端功能概览
模块	功能
登录注册页	用户登录、注册、忘记密码
主界面	聊天列表、好友列表、通知列表
聊天窗口	消息展示、表情、图片发送、输入框
通知中心	系统通知、未读提示、点击跳转详情
个人中心	用户资料修改、状态设置、退出登录
七、接口设计示例
接口	方法	描述
/api/auth/login	POST	用户登录
/api/friend/add	POST	添加好友
/api/chat/send	POST	发送消息（备选HTTP版）
/ws/chat	WS	WebSocket 通信通道
/api/chat/history	GET	查询聊天记录
/api/notify/unread	GET	获取未读通知
/api/notify/read/{id}	PUT	标记通知为已读
八、数据库设计概览

主要表：

user（用户信息）

friend（好友关系）

chat_message（聊天消息）

notification（系统通知）

friend_group（好友分组）

九、性能与安全要求
项目	要求
并发支持	500+ 并发连接（WebSocket）
延迟	消息传递延迟 ≤ 200ms
安全	JWT 鉴权、消息体过滤、XSS 防护
持久化	定期归档聊天记录