PRD：基于 Spring Boot 的零食铺子仓储管理系统（项目 034）

一、项目背景
- 线下零食铺子品类多、保质期短，需精细化批次/效期管理和快速出入库。
- 现有手工或表格管理易错、库存不准，缺货与近效期损耗高。

二、目标与成功指标
- 目标：构建一套面向小型零食连锁/单店的轻量级仓储管理系统，支持多仓库、批次/效期、预警与可视化报表。
- 成功指标：
  - 库存准确率 ≥ 98%（盘点差异率 ≤ 2%）
  - 近效期报废率较基线下降 ≥ 30%
  - 缺货率较基线下降 ≥ 20%
  - 入库、出库单据平均处理时长 < 3 分钟

三、用户与角色
- 系统管理员：配置、权限、字典、通知渠道。
- 仓库管理员：入库、出库、调拨、盘点、质检、标签打印。
- 采购员：采购单、供应商、到货预约、补货建议。
- 销售/店员：销售出库、退货、拣货/复核。
- 财务/经理：成本、报表、审核。

四、业务范围与核心流程
- 基础资料：商品/SPU-SKU、包装规格、多条码、保质期规则、仓库/库区/库位、供应商、客户、字典配置。
- 入库：采购入库、退货返厂入库、调拨入库、其他入库；质检、上架、标签打印（含批次/效期/条码）。
- 出库：销售出库（锁定库存→拣货→复核→出库），调拨出库，退货给供应商。
- 库存：实时库存、批次/效期、库存锁定（订单级）、安全库存、库存冻结/解冻。
- 盘点：全盘/抽盘/动碰盘，差异处理。
- 调拨：跨仓、跨库区调拨，支持批次带出。
- 预警：安全库存、近效期（X 天内）、滞销（Y 天无出库）、缺货。
- 报表：库存余额（按仓/库位/批次）、收发存日报、近效期清单、缺货/超储、滞销、出入库明细、拣货绩效。
- 日志与追溯：单据流转、批次/效期跟踪、操作日志。
- 导入导出：商品、供应商、客户、初始库存、单据明细（CSV/Excel）。
- 通知：邮件/站内消息（近效期、缺货、审批结果）。
- 权限：基于角色的菜单/接口权限，细粒度到仓库/库区/单据类型。

五、非功能需求
- 性能：核心查询/提交接口 P95 < 300ms（并发 200）；批次列表分页支持 10k 数据量级。
- 可用性：业务时间可用性 ≥ 99.9%；关键操作可幂等。
- 安全：JWT 鉴权，RBAC，操作审计，敏感字段脱敏展示。
- 可靠性：关键单据落库后异步写审计/日志；通知失败重试。
- 可扩展：多仓、多店支持；配置化预警阈值。
- 易用性：移动端/小程序友好拣货界面，条码枪扫描兼容。

六、技术选型（遵循 rule.md 范围）
- 后端：Spring Boot + MyBatis-Plus，数据库 MySQL；Redis 做缓存与分布式锁；Spring Security + JWT；Spring Task 定时预警；OpenAPI/Swagger。
- 消息/异步：可选 RabbitMQ/内置事件异步处理（用于通知与审计）。
- 前端（可后续实现）：Vue 或纯 HTML（不使用 npx 脚手架），支持桌面与移动端。
- 部署：Maven 构建，Docker 可选；日志 ELK/本地文件。

七、数据模型（初稿，后续详设）
- 商品：SPU、SKU、包装规格、多条码、保质期天数。
- 仓储：仓库、库区、库位（可分温区/货架/层），库位容量。
- 库存：库存记录（仓库+库位+SKU+批次+效期+可用/锁定/冻结）、库存流水。
- 单据：采购入库单、出库单（销售/调拨/退供）、调拨单、盘点单、其他入出库单；单据状态流转。
- 供应链：供应商、客户；往来退货记录。
- 预警配置：安全库存阈值、近效期天数、滞销天数、通知渠道。
- 审计：操作日志、单据流转日志、通知发送记录。

八、关键规则
- 批次/效期管理：入库必须记录生产/到期日；拣货默认先进先出+近效期优先。
- 库存锁定：销售下单即锁定，可部分释放或转出库；盘点可冻结对应库位。
- 成本：移动加权为主，支持配置为批次成本。
- 审批：调拨、异常盘点差异可配置审批流。

九、里程碑（建议）
- M0：PRD 确认
- M1：核心数据模型与入/出库、库存查询、批次效期
- M2：盘点、调拨、预警、报表
- M3：权限、安全、通知、性能与稳定性优化

十、范围外（当前阶段不做）
- 全链路运输/配送调度
- 完整财务总账、发票管理
- 复杂波次/分区拣货优化算法
